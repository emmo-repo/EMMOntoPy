
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the EMMOntoPy library">
      
      
      
        <link rel="canonical" href="https://emmo-repo.github.io/EMMOntoPy/latest/api_reference/ontopy/excelparser/">
      
      
        <link rel="prev" href="../colortest/">
      
      
        <link rel="next" href="../graph/">
      
      
      <link rel="icon" href="../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.10">
    
    
      
        <title>excelparser - EMMOntoPy</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.fad675c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/reference.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="light-green">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#excelparser" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="EMMOntoPy" class="md-header__button md-logo" aria-label="EMMOntoPy" data-md-component="logo">
      
  <img src="../../../images/emmontopy-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EMMOntoPy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              excelparser
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/emmo-repo/EMMOntoPy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    EMMOntoPy
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="EMMOntoPy" class="md-nav__button md-logo" aria-label="EMMOntoPy" data-md-component="logo">
      
  <img src="../../../images/emmontopy-logo.svg" alt="logo">

    </a>
    EMMOntoPy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/emmo-repo/EMMOntoPy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    EMMOntoPy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools-instructions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tools
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../docker-instructions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../LICENSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples and demonstrations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples and demonstrations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Demo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Demo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../demo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EMMO use cases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../demo/horizontal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EMMO use case for horizontal interoperability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../demo/vertical/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EMMO use case for vertical interoperability
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/emmodoc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EMMOdoc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/jupyter-visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter visualization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/ontology-from-excel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ontology generation from Excel
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/release-instructions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Steps for creating a new release
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing and tooling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" >
        
          
          <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    emmopy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            emmopy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../emmopy/emmocheck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emmocheck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../emmopy/emmopy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emmopy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" checked>
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ontopy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            ontopy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../colortest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    colortest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    excelparser
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    excelparser
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ontopy.excelparser" class="md-nav__link">
    <span class="md-ellipsis">
      ontopy.excelparser
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ontopy.excelparser.ExcelError" class="md-nav__link">
    <span class="md-ellipsis">
      ExcelError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ontopy.excelparser.create_ontology_from_excel" class="md-nav__link">
    <span class="md-ellipsis">
      create_ontology_from_excel()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ontopy.excelparser.create_ontology_from_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      create_ontology_from_pandas()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ontopy.excelparser.get_metadata_from_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata_from_dataframe()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graph
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../manchester/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    manchester
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../nadict/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nadict
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ontodoc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ontodoc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ontology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ontology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../patch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    patch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_10" >
        
          
          <label class="md-nav__link" for="__nav_8_2_10" id="__nav_8_2_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    factpluspluswrapper
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_10">
            <span class="md-nav__icon md-icon"></span>
            factpluspluswrapper
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../factpluspluswrapper/factppgraph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    factppgraph
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../factpluspluswrapper/owlapi_interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    owlapi_interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../factpluspluswrapper/sync_factpp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sync_factpp
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ontopy.excelparser" class="md-nav__link">
    <span class="md-ellipsis">
      ontopy.excelparser
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ontopy.excelparser.ExcelError" class="md-nav__link">
    <span class="md-ellipsis">
      ExcelError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ontopy.excelparser.create_ontology_from_excel" class="md-nav__link">
    <span class="md-ellipsis">
      create_ontology_from_excel()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ontopy.excelparser.create_ontology_from_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      create_ontology_from_pandas()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ontopy.excelparser.get_metadata_from_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata_from_dataframe()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="excelparser">excelparser<a class="headerlink" href="#excelparser" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-module">

<a id="ontopy.excelparser"></a>
    <div class="doc doc-contents first">

      <p>Module from parsing an excelfile and creating an
ontology from it.</p>
<p>The excelfile is read by pandas and the pandas
dataframe should have column names:
prefLabel, altLabel, Elucidation, Comments, Examples,
subClassOf, Relations.</p>
<p>Note that correct case is mandatory.</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h2 id="ontopy.excelparser.ExcelError" class="doc doc-heading">
        <code>
ExcelError            (<a class="autorefs autorefs-internal" title="ontopy.utils.EMMOntoPyException" href="../utils/#ontopy.utils.EMMOntoPyException">EMMOntoPyException</a>)
        </code>



<a href="#ontopy.excelparser.ExcelError" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Raised on errors in Excel file.</p>

        <details class="quote">
          <summary>Source code in <code>ontopy/excelparser.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ExcelError</span><span class="p">(</span><span class="n">EMMOntoPyException</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised on errors in Excel file.&quot;&quot;&quot;</span>
</code></pre></div>
        </details>


    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="ontopy.excelparser.create_ontology_from_excel" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_ontology_from_excel</span><span class="p">(</span><span class="n">excelpath</span><span class="p">,</span> <span class="n">concept_sheet_name</span><span class="o">=</span><span class="s1">&#39;Concepts&#39;</span><span class="p">,</span> <span class="n">metadata_sheet_name</span><span class="o">=</span><span class="s1">&#39;Metadata&#39;</span><span class="p">,</span> <span class="n">imports_sheet_name</span><span class="o">=</span><span class="s1">&#39;ImportedOntologies&#39;</span><span class="p">,</span> <span class="n">dataproperties_sheet_name</span><span class="o">=</span><span class="s1">&#39;DataProperties&#39;</span><span class="p">,</span> <span class="n">objectproperties_sheet_name</span><span class="o">=</span><span class="s1">&#39;ObjectProperties&#39;</span><span class="p">,</span> <span class="n">annotationproperties_sheet_name</span><span class="o">=</span><span class="s1">&#39;AnnotationProperties&#39;</span><span class="p">,</span> <span class="n">base_iri</span><span class="o">=</span><span class="s1">&#39;http://emmo.info/emmo/domain/onto#&#39;</span><span class="p">,</span> <span class="n">base_iri_from_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">imports</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">input_ontology</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#ontopy.excelparser.create_ontology_from_excel" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates an ontology from an Excel-file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>excelpath</code></td>
        <td><code>str</code></td>
        <td><p>Path to Excel workbook.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>concept_sheet_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of sheet where concepts are defined.
The second row of this sheet should contain column names that are
supported. Currently these are 'prefLabel','altLabel',
'Elucidation', 'Comments', 'Examples', 'subClassOf', 'Relations'.
Multiple entries are separated with ';'.</p></td>
        <td><code>&#39;Concepts&#39;</code></td>
      </tr>
      <tr>
        <td><code>metadata_sheet_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of sheet where metadata are defined.
The first row contains column names 'Metadata name' and 'Value'
Supported 'Metadata names' are: 'Ontology IRI',
'Ontology vesion IRI', 'Ontology version Info', 'Title',
'Abstract', 'License', 'Comment', 'Author', 'Contributor'.
Multiple entries are separated with a semi-colon (<code>;</code>).</p></td>
        <td><code>&#39;Metadata&#39;</code></td>
      </tr>
      <tr>
        <td><code>imports_sheet_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of sheet where imported ontologies are
defined.
Column name is 'Imported ontologies'.
Fully resolvable URL or path to imported ontologies provided one
per row.</p></td>
        <td><code>&#39;ImportedOntologies&#39;</code></td>
      </tr>
      <tr>
        <td><code>dataproperties_sheet_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of sheet where data properties are
defined. The second row of this sheet should contain column names
that are supported. Currently these are 'prefLabel','altLabel',
'Elucidation', 'Comments', 'Examples', 'subPropertyOf',
'Domain', 'Range', 'dijointWith', 'equivalentTo'.</p></td>
        <td><code>&#39;DataProperties&#39;</code></td>
      </tr>
      <tr>
        <td><code>annotationproperties_sheet_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of sheet where annotation
properties are defined. The second row of this sheet should contain
column names that are supported. Currently these are 'prefLabel',
'altLabel', 'Elucidation', 'Comments', 'Examples', 'subPropertyOf',
'Domain', 'Range'.</p></td>
        <td><code>&#39;AnnotationProperties&#39;</code></td>
      </tr>
      <tr>
        <td><code>objectproperties_sheet_name</code></td>
        <td><code>str</code></td>
        <td><p>Name of sheet where object properties are
defined.The second row of this sheet should contain column names
that are supported. Currently these are 'prefLabel','altLabel',
'Elucidation', 'Comments', 'Examples', 'subPropertyOf',
'Domain', 'Range', 'inverseOf', 'dijointWith', 'equivalentTo'.</p></td>
        <td><code>&#39;ObjectProperties&#39;</code></td>
      </tr>
      <tr>
        <td><code>base_iri</code></td>
        <td><code>str</code></td>
        <td><p>Base IRI of the new ontology.</p></td>
        <td><code>&#39;http://emmo.info/emmo/domain/onto#&#39;</code></td>
      </tr>
      <tr>
        <td><code>base_iri_from_metadata</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use base IRI defined from metadata.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>imports</code></td>
        <td><code>list</code></td>
        <td><p>List of imported ontologies.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>catalog</code></td>
        <td><code>dict</code></td>
        <td><p>Imported ontologies with (name, full path) key/value-pairs.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>force</code></td>
        <td><code>bool</code></td>
        <td><p>Forcibly make an ontology by skipping concepts
that are erroneously defined or other errors in the excel sheet.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>input_ontology</code></td>
        <td><code>Optional[ontopy.ontology.Ontology]</code></td>
        <td><p>Ontology that should be updated.
Default is None,
which means that a completely new ontology is generated.
If an input_ontology to be updated is provided,
the metadata sheet in the excel sheet will not be considered.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>A tuple with the</code></td>
      <td><ul>
<li>created ontology<ul>
<li>associated catalog of ontology names and resolvable path as dict</li>
<li>
<p>a dictionary with lists of concepts that raise errors, with the
  following keys:</p>
<ul>
<li>"already_defined": These are concepts (classes)
    that are already in the
    ontology, because they were already added in a
    previous line of the excelfile/pandas dataframe, or because
    it is already defined in an imported ontology with the same
    base_iri as the newly created ontology.</li>
<li>"in_imported_ontologies": Concepts (classes)
    that are defined in the
    excel, but already exist in the imported ontologies.</li>
<li>"wrongly_defined": Concepts (classes) that are given an
    invalid prefLabel (e.g. with a space in the name).</li>
<li>"missing_subClassOf": Concepts (classes) that are missing
    parents. These concepts are added directly under owl:Thing.</li>
<li>"invalid_subClassOf": Concepts (classes) with invalidly
    defined parents.
    These concepts are added directly under owl:Thing.</li>
<li>"nonadded_concepts": List of all concepts (classes) that are
    not added,
    either because the prefLabel is invalid, or because the
    concept has already been added once or already exists in an
    imported ontology.</li>
<li>"obj_prop_already_defined": Object properties that are already
    defined in the ontology.</li>
<li>"obj_prop_in_imported_ontologies": Object properties that are
    defined in the excel, but already exist in the imported
    ontologies.</li>
<li>"obj_prop_wrongly_defined": Object properties that are given
    an invalid prefLabel (e.g. with a space in the name).</li>
<li>"obj_prop_missing_subPropertyOf": Object properties that are
    missing parents.</li>
<li>"obj_prop_invalid_subPropertyOf": Object properties with
    invalidly defined parents.</li>
<li>"obj_prop_nonadded_entities": List of all object properties
    that are not added, either because the prefLabel is invalid,
    or because the concept has already been added once or
    already exists in an imported ontology.</li>
<li>"obj_prop_errors_in_properties": Object properties with
    invalidly defined properties.</li>
<li>"obj_prop_errors_in_range": Object properties with invalidly
    defined range.</li>
<li>"obj_prop_errors_in_domain": Object properties with invalidly
    defined domain.</li>
<li>"annot_prop_already_defined": Annotation properties that are
    already defined in the ontology.</li>
<li>"annot_prop_in_imported_ontologies":  Annotation properties
    that
    are defined in the excel, but already exist in the imported
    ontologies.</li>
<li>"annot_prop_wrongly_defined": Annotation properties that are
    given an invalid prefLabel (e.g. with a space in the name).</li>
<li>"annot_prop_missing_subPropertyOf": Annotation properties that
    are missing parents.</li>
<li>"annot_prop_invalid_subPropertyOf": Annotation properties with
    invalidly defined parents.</li>
<li>"annot_prop_nonadded_entities": List of all annotation
    properties that are not added, either because the prefLabel
    is invalid, or because the concept has already been added
    once or already exists in an imported ontology.</li>
<li>"annot_prop_errors_in_properties": Annotation properties with
    invalidly defined properties.</li>
<li>"data_prop_already_defined": Data properties that are already
    defined in the ontology.</li>
<li>"data_prop_in_imported_ontologies": Data properties that are
    defined in the excel, but already exist in the imported
    ontologies.</li>
<li>"data_prop_wrongly_defined":  Data properties that are given
    an invalid prefLabel (e.g. with a space in the name).</li>
<li>"data_prop_missing_subPropertyOf": Data properties that are
    missing parents.</li>
<li>"data_prop_invalid_subPropertyOf": Data properties with
    invalidly defined parents.</li>
<li>"data_prop_nonadded_entities": List of all data properties
    that are not added, either because the prefLabel is invalid,
    or because the concept has already been added once or
    already exists in an imported ontology.</li>
<li>"data_prop_errors_in_properties": Data properties with
    invalidly defined properties.</li>
<li>"data_prop_errors_in_range": Data properties with invalidly
    defined range.</li>
<li>"data_prop_errors_in_domain": Data properties with invalidly
    defined domain.</li>
</ul>
</li>
</ul>
</li>
</ul></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ontopy/excelparser.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_ontology_from_excel</span><span class="p">(</span>  <span class="c1"># pylint: disable=too-many-arguments, too-many-locals</span>
    <span class="n">excelpath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">concept_sheet_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Concepts&quot;</span><span class="p">,</span>
    <span class="n">metadata_sheet_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Metadata&quot;</span><span class="p">,</span>
    <span class="n">imports_sheet_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ImportedOntologies&quot;</span><span class="p">,</span>
    <span class="n">dataproperties_sheet_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;DataProperties&quot;</span><span class="p">,</span>
    <span class="n">objectproperties_sheet_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ObjectProperties&quot;</span><span class="p">,</span>
    <span class="n">annotationproperties_sheet_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;AnnotationProperties&quot;</span><span class="p">,</span>
    <span class="n">base_iri</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;http://emmo.info/emmo/domain/onto#&quot;</span><span class="p">,</span>
    <span class="n">base_iri_from_metadata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">imports</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">input_ontology</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ontopy</span><span class="o">.</span><span class="n">ontology</span><span class="o">.</span><span class="n">Ontology</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">ontopy</span><span class="o">.</span><span class="n">ontology</span><span class="o">.</span><span class="n">Ontology</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates an ontology from an Excel-file.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        excelpath: Path to Excel workbook.</span>
<span class="sd">        concept_sheet_name: Name of sheet where concepts are defined.</span>
<span class="sd">            The second row of this sheet should contain column names that are</span>
<span class="sd">            supported. Currently these are &#39;prefLabel&#39;,&#39;altLabel&#39;,</span>
<span class="sd">            &#39;Elucidation&#39;, &#39;Comments&#39;, &#39;Examples&#39;, &#39;subClassOf&#39;, &#39;Relations&#39;.</span>
<span class="sd">            Multiple entries are separated with &#39;;&#39;.</span>
<span class="sd">        metadata_sheet_name: Name of sheet where metadata are defined.</span>
<span class="sd">            The first row contains column names &#39;Metadata name&#39; and &#39;Value&#39;</span>
<span class="sd">            Supported &#39;Metadata names&#39; are: &#39;Ontology IRI&#39;,</span>
<span class="sd">            &#39;Ontology vesion IRI&#39;, &#39;Ontology version Info&#39;, &#39;Title&#39;,</span>
<span class="sd">            &#39;Abstract&#39;, &#39;License&#39;, &#39;Comment&#39;, &#39;Author&#39;, &#39;Contributor&#39;.</span>
<span class="sd">            Multiple entries are separated with a semi-colon (`;`).</span>
<span class="sd">        imports_sheet_name: Name of sheet where imported ontologies are</span>
<span class="sd">            defined.</span>
<span class="sd">            Column name is &#39;Imported ontologies&#39;.</span>
<span class="sd">            Fully resolvable URL or path to imported ontologies provided one</span>
<span class="sd">            per row.</span>
<span class="sd">        dataproperties_sheet_name: Name of sheet where data properties are</span>
<span class="sd">            defined. The second row of this sheet should contain column names</span>
<span class="sd">            that are supported. Currently these are &#39;prefLabel&#39;,&#39;altLabel&#39;,</span>
<span class="sd">            &#39;Elucidation&#39;, &#39;Comments&#39;, &#39;Examples&#39;, &#39;subPropertyOf&#39;,</span>
<span class="sd">            &#39;Domain&#39;, &#39;Range&#39;, &#39;dijointWith&#39;, &#39;equivalentTo&#39;.</span>
<span class="sd">        annotationproperties_sheet_name: Name of sheet where annotation</span>
<span class="sd">            properties are defined. The second row of this sheet should contain</span>
<span class="sd">            column names that are supported. Currently these are &#39;prefLabel&#39;,</span>
<span class="sd">            &#39;altLabel&#39;, &#39;Elucidation&#39;, &#39;Comments&#39;, &#39;Examples&#39;, &#39;subPropertyOf&#39;,</span>
<span class="sd">            &#39;Domain&#39;, &#39;Range&#39;.</span>
<span class="sd">        objectproperties_sheet_name: Name of sheet where object properties are</span>
<span class="sd">            defined.The second row of this sheet should contain column names</span>
<span class="sd">            that are supported. Currently these are &#39;prefLabel&#39;,&#39;altLabel&#39;,</span>
<span class="sd">            &#39;Elucidation&#39;, &#39;Comments&#39;, &#39;Examples&#39;, &#39;subPropertyOf&#39;,</span>
<span class="sd">            &#39;Domain&#39;, &#39;Range&#39;, &#39;inverseOf&#39;, &#39;dijointWith&#39;, &#39;equivalentTo&#39;.</span>
<span class="sd">        base_iri: Base IRI of the new ontology.</span>
<span class="sd">        base_iri_from_metadata: Whether to use base IRI defined from metadata.</span>
<span class="sd">        imports: List of imported ontologies.</span>
<span class="sd">        catalog: Imported ontologies with (name, full path) key/value-pairs.</span>
<span class="sd">        force: Forcibly make an ontology by skipping concepts</span>
<span class="sd">            that are erroneously defined or other errors in the excel sheet.</span>
<span class="sd">        input_ontology: Ontology that should be updated.</span>
<span class="sd">            Default is None,</span>
<span class="sd">            which means that a completely new ontology is generated.</span>
<span class="sd">            If an input_ontology to be updated is provided,</span>
<span class="sd">            the metadata sheet in the excel sheet will not be considered.</span>


<span class="sd">    Returns:</span>
<span class="sd">        A tuple with the:</span>

<span class="sd">            * created ontology</span>
<span class="sd">            * associated catalog of ontology names and resolvable path as dict</span>
<span class="sd">            * a dictionary with lists of concepts that raise errors, with the</span>
<span class="sd">              following keys:</span>

<span class="sd">                - &quot;already_defined&quot;: These are concepts (classes)</span>
<span class="sd">                    that are already in the</span>
<span class="sd">                    ontology, because they were already added in a</span>
<span class="sd">                    previous line of the excelfile/pandas dataframe, or because</span>
<span class="sd">                    it is already defined in an imported ontology with the same</span>
<span class="sd">                    base_iri as the newly created ontology.</span>
<span class="sd">                - &quot;in_imported_ontologies&quot;: Concepts (classes)</span>
<span class="sd">                    that are defined in the</span>
<span class="sd">                    excel, but already exist in the imported ontologies.</span>
<span class="sd">                - &quot;wrongly_defined&quot;: Concepts (classes) that are given an</span>
<span class="sd">                    invalid prefLabel (e.g. with a space in the name).</span>
<span class="sd">                - &quot;missing_subClassOf&quot;: Concepts (classes) that are missing</span>
<span class="sd">                    parents. These concepts are added directly under owl:Thing.</span>
<span class="sd">                - &quot;invalid_subClassOf&quot;: Concepts (classes) with invalidly</span>
<span class="sd">                    defined parents.</span>
<span class="sd">                    These concepts are added directly under owl:Thing.</span>
<span class="sd">                - &quot;nonadded_concepts&quot;: List of all concepts (classes) that are</span>
<span class="sd">                    not added,</span>
<span class="sd">                    either because the prefLabel is invalid, or because the</span>
<span class="sd">                    concept has already been added once or already exists in an</span>
<span class="sd">                    imported ontology.</span>
<span class="sd">                - &quot;obj_prop_already_defined&quot;: Object properties that are already</span>
<span class="sd">                    defined in the ontology.</span>
<span class="sd">                - &quot;obj_prop_in_imported_ontologies&quot;: Object properties that are</span>
<span class="sd">                    defined in the excel, but already exist in the imported</span>
<span class="sd">                    ontologies.</span>
<span class="sd">                - &quot;obj_prop_wrongly_defined&quot;: Object properties that are given</span>
<span class="sd">                    an invalid prefLabel (e.g. with a space in the name).</span>
<span class="sd">                - &quot;obj_prop_missing_subPropertyOf&quot;: Object properties that are</span>
<span class="sd">                    missing parents.</span>
<span class="sd">                - &quot;obj_prop_invalid_subPropertyOf&quot;: Object properties with</span>
<span class="sd">                    invalidly defined parents.</span>
<span class="sd">                - &quot;obj_prop_nonadded_entities&quot;: List of all object properties</span>
<span class="sd">                    that are not added, either because the prefLabel is invalid,</span>
<span class="sd">                    or because the concept has already been added once or</span>
<span class="sd">                    already exists in an imported ontology.</span>
<span class="sd">                - &quot;obj_prop_errors_in_properties&quot;: Object properties with</span>
<span class="sd">                    invalidly defined properties.</span>
<span class="sd">                - &quot;obj_prop_errors_in_range&quot;: Object properties with invalidly</span>
<span class="sd">                    defined range.</span>
<span class="sd">                - &quot;obj_prop_errors_in_domain&quot;: Object properties with invalidly</span>
<span class="sd">                    defined domain.</span>
<span class="sd">                - &quot;annot_prop_already_defined&quot;: Annotation properties that are</span>
<span class="sd">                    already defined in the ontology.</span>
<span class="sd">                - &quot;annot_prop_in_imported_ontologies&quot;:  Annotation properties</span>
<span class="sd">                    that</span>
<span class="sd">                    are defined in the excel, but already exist in the imported</span>
<span class="sd">                    ontologies.</span>
<span class="sd">                - &quot;annot_prop_wrongly_defined&quot;: Annotation properties that are</span>
<span class="sd">                    given an invalid prefLabel (e.g. with a space in the name).</span>
<span class="sd">                - &quot;annot_prop_missing_subPropertyOf&quot;: Annotation properties that</span>
<span class="sd">                    are missing parents.</span>
<span class="sd">                - &quot;annot_prop_invalid_subPropertyOf&quot;: Annotation properties with</span>
<span class="sd">                    invalidly defined parents.</span>
<span class="sd">                - &quot;annot_prop_nonadded_entities&quot;: List of all annotation</span>
<span class="sd">                    properties that are not added, either because the prefLabel</span>
<span class="sd">                    is invalid, or because the concept has already been added</span>
<span class="sd">                    once or already exists in an imported ontology.</span>
<span class="sd">                - &quot;annot_prop_errors_in_properties&quot;: Annotation properties with</span>
<span class="sd">                    invalidly defined properties.</span>
<span class="sd">                - &quot;data_prop_already_defined&quot;: Data properties that are already</span>
<span class="sd">                    defined in the ontology.</span>
<span class="sd">                - &quot;data_prop_in_imported_ontologies&quot;: Data properties that are</span>
<span class="sd">                    defined in the excel, but already exist in the imported</span>
<span class="sd">                    ontologies.</span>
<span class="sd">                - &quot;data_prop_wrongly_defined&quot;:  Data properties that are given</span>
<span class="sd">                    an invalid prefLabel (e.g. with a space in the name).</span>
<span class="sd">                - &quot;data_prop_missing_subPropertyOf&quot;: Data properties that are</span>
<span class="sd">                    missing parents.</span>
<span class="sd">                - &quot;data_prop_invalid_subPropertyOf&quot;: Data properties with</span>
<span class="sd">                    invalidly defined parents.</span>
<span class="sd">                - &quot;data_prop_nonadded_entities&quot;: List of all data properties</span>
<span class="sd">                    that are not added, either because the prefLabel is invalid,</span>
<span class="sd">                    or because the concept has already been added once or</span>
<span class="sd">                    already exists in an imported ontology.</span>
<span class="sd">                - &quot;data_prop_errors_in_properties&quot;: Data properties with</span>
<span class="sd">                    invalidly defined properties.</span>
<span class="sd">                - &quot;data_prop_errors_in_range&quot;: Data properties with invalidly</span>
<span class="sd">                    defined range.</span>
<span class="sd">                - &quot;data_prop_errors_in_domain&quot;: Data properties with invalidly</span>
<span class="sd">                    defined domain.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">web_protocol</span> <span class="o">=</span> <span class="s2">&quot;http://&quot;</span><span class="p">,</span> <span class="s2">&quot;https://&quot;</span><span class="p">,</span> <span class="s2">&quot;ftp://&quot;</span>

    <span class="k">def</span> <span class="nf">_relative_to_absolute_paths</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">web_protocol</span><span class="p">):</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">excelpath</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">imports</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
            <span class="n">excelpath</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">imports_sheet_name</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">imports</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Strip leading and trailing white spaces in paths</span>
        <span class="n">imports</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^\s+&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;\s+$&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="c1"># Set empty strings to nan</span>
        <span class="n">imports</span> <span class="o">=</span> <span class="n">imports</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^\s*$&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;Imported ontologies&quot;</span> <span class="ow">in</span> <span class="n">imports</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">imports</span><span class="p">[</span><span class="s2">&quot;Imported ontologies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imports</span><span class="p">[</span>
                <span class="s2">&quot;Imported ontologies&quot;</span>
            <span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">_relative_to_absolute_paths</span><span class="p">)</span>

    <span class="c1"># Read datafile TODO: Some magic to identify the header row</span>
    <span class="n">conceptdata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
        <span class="n">excelpath</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">concept_sheet_name</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">objectproperties</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
            <span class="n">excelpath</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">objectproperties_sheet_name</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;prefLabel&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">objectproperties</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The &#39;prefLabel&#39; column is missing in &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">objectproperties_sheet_name</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="s2">&quot;New object properties will not be added to the ontology.&quot;</span>
            <span class="p">)</span>
            <span class="n">objectproperties</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No sheet named </span><span class="si">{</span><span class="n">objectproperties_sheet_name</span><span class="si">}</span><span class="s2"> found &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;in </span><span class="si">{</span><span class="n">excelpath</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="s2">&quot;New object properties will not be added to the ontology.&quot;</span>
        <span class="p">)</span>
        <span class="n">objectproperties</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">annotationproperties</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
            <span class="n">excelpath</span><span class="p">,</span>
            <span class="n">sheet_name</span><span class="o">=</span><span class="n">annotationproperties_sheet_name</span><span class="p">,</span>
            <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;prefLabel&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">annotationproperties</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The &#39;prefLabel&#39; column is missing in &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">annotationproperties_sheet_name</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="s2">&quot;New annotation properties will not be added to the ontology.&quot;</span>
            <span class="p">)</span>
            <span class="n">annotationproperties</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No sheet named </span><span class="si">{</span><span class="n">annotationproperties_sheet_name</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;found in </span><span class="si">{</span><span class="n">excelpath</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="s2">&quot;New annotation properties will not be added to the ontology.&quot;</span>
        <span class="p">)</span>
        <span class="n">annotationproperties</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">dataproperties</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
            <span class="n">excelpath</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">dataproperties_sheet_name</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;prefLabel&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dataproperties</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The &#39;prefLabel&#39; column is missing in &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataproperties_sheet_name</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="s2">&quot;New data properties will not be added to the ontology.&quot;</span>
            <span class="p">)</span>
            <span class="n">dataproperties</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No sheet named </span><span class="si">{</span><span class="n">dataproperties_sheet_name</span><span class="si">}</span><span class="s2"> found in </span><span class="si">{</span><span class="n">excelpath</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="s2">&quot;New data properties will not be added to the ontology.&quot;</span>
        <span class="p">)</span>
        <span class="n">dataproperties</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">excelpath</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">metadata_sheet_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">create_ontology_from_pandas</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">conceptdata</span><span class="p">,</span>
        <span class="n">objectproperties</span><span class="o">=</span><span class="n">objectproperties</span><span class="p">,</span>
        <span class="n">dataproperties</span><span class="o">=</span><span class="n">dataproperties</span><span class="p">,</span>
        <span class="n">annotationproperties</span><span class="o">=</span><span class="n">annotationproperties</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">imports</span><span class="o">=</span><span class="n">imports</span><span class="p">,</span>
        <span class="n">base_iri</span><span class="o">=</span><span class="n">base_iri</span><span class="p">,</span>
        <span class="n">base_iri_from_metadata</span><span class="o">=</span><span class="n">base_iri_from_metadata</span><span class="p">,</span>
        <span class="n">catalog</span><span class="o">=</span><span class="n">catalog</span><span class="p">,</span>
        <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
        <span class="n">input_ontology</span><span class="o">=</span><span class="n">input_ontology</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ontopy.excelparser.create_ontology_from_pandas" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_ontology_from_pandas</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">objectproperties</span><span class="p">,</span> <span class="n">annotationproperties</span><span class="p">,</span> <span class="n">dataproperties</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">imports</span><span class="p">,</span> <span class="n">base_iri</span><span class="o">=</span><span class="s1">&#39;http://emmo.info/emmo/domain/onto#&#39;</span><span class="p">,</span> <span class="n">base_iri_from_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">input_ontology</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#ontopy.excelparser.create_ontology_from_pandas" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create an ontology from a pandas DataFrame.</p>
<p>Check 'create_ontology_from_excel' for complete documentation.</p>

        <details class="quote">
          <summary>Source code in <code>ontopy/excelparser.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_ontology_from_pandas</span><span class="p">(</span>  <span class="c1"># pylint:disable=too-many-locals,too-many-branches,too-many-statements,too-many-arguments</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">objectproperties</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">annotationproperties</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">dataproperties</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">imports</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">base_iri</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;http://emmo.info/emmo/domain/onto#&quot;</span><span class="p">,</span>
    <span class="n">base_iri_from_metadata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">input_ontology</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ontopy</span><span class="o">.</span><span class="n">ontology</span><span class="o">.</span><span class="n">Ontology</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">ontopy</span><span class="o">.</span><span class="n">ontology</span><span class="o">.</span><span class="n">Ontology</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an ontology from a pandas DataFrame.</span>

<span class="sd">    Check &#39;create_ontology_from_excel&#39; for complete documentation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get ontology to which new concepts should be added</span>
    <span class="k">if</span> <span class="n">input_ontology</span><span class="p">:</span>
        <span class="n">onto</span> <span class="o">=</span> <span class="n">input_ontology</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Create new ontology</span>
        <span class="n">onto</span><span class="p">,</span> <span class="n">catalog</span> <span class="o">=</span> <span class="n">get_metadata_from_dataframe</span><span class="p">(</span>
            <span class="n">metadata</span><span class="p">,</span> <span class="n">base_iri</span><span class="p">,</span> <span class="n">imports</span><span class="o">=</span><span class="n">imports</span>
        <span class="p">)</span>

        <span class="c1"># Set given or default base_iri if base_iri_from_metadata is False.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">base_iri_from_metadata</span><span class="p">:</span>
            <span class="n">onto</span><span class="o">.</span><span class="n">base_iri</span> <span class="o">=</span> <span class="n">base_iri</span>
    <span class="c1"># onto.sync_python_names()</span>
    <span class="c1"># prefLabel, label, and altLabel</span>
    <span class="c1"># are default label annotations</span>
    <span class="n">onto</span><span class="o">.</span><span class="n">set_default_label_annotations</span><span class="p">()</span>
    <span class="c1"># Add object properties</span>
    <span class="k">if</span> <span class="n">objectproperties</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">objectproperties</span> <span class="o">=</span> <span class="n">_clean_dataframe</span><span class="p">(</span><span class="n">objectproperties</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="n">onto</span><span class="p">,</span>
            <span class="n">objectproperties_with_errors</span><span class="p">,</span>
            <span class="n">added_objprop_indices</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">_add_entities</span><span class="p">(</span>
            <span class="n">onto</span><span class="o">=</span><span class="n">onto</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">objectproperties</span><span class="p">,</span>
            <span class="n">entitytype</span><span class="o">=</span><span class="n">owlready2</span><span class="o">.</span><span class="n">ObjectPropertyClass</span><span class="p">,</span>
            <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">annotationproperties</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">annotationproperties</span> <span class="o">=</span> <span class="n">_clean_dataframe</span><span class="p">(</span><span class="n">annotationproperties</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="n">onto</span><span class="p">,</span>
            <span class="n">annotationproperties_with_errors</span><span class="p">,</span>
            <span class="n">added_annotprop_indices</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">_add_entities</span><span class="p">(</span>
            <span class="n">onto</span><span class="o">=</span><span class="n">onto</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">annotationproperties</span><span class="p">,</span>
            <span class="n">entitytype</span><span class="o">=</span><span class="n">owlready2</span><span class="o">.</span><span class="n">AnnotationPropertyClass</span><span class="p">,</span>
            <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">dataproperties</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dataproperties</span> <span class="o">=</span> <span class="n">_clean_dataframe</span><span class="p">(</span><span class="n">dataproperties</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="n">onto</span><span class="p">,</span>
            <span class="n">dataproperties_with_errors</span><span class="p">,</span>
            <span class="n">added_dataprop_indices</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">_add_entities</span><span class="p">(</span>
            <span class="n">onto</span><span class="o">=</span><span class="n">onto</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">dataproperties</span><span class="p">,</span>
            <span class="n">entitytype</span><span class="o">=</span><span class="n">owlready2</span><span class="o">.</span><span class="n">DataPropertyClass</span><span class="p">,</span>
            <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">onto</span><span class="o">.</span><span class="n">sync_attributes</span><span class="p">(</span>
        <span class="n">name_policy</span><span class="o">=</span><span class="s2">&quot;uuid&quot;</span><span class="p">,</span> <span class="n">name_prefix</span><span class="o">=</span><span class="s2">&quot;EMMO_&quot;</span><span class="p">,</span> <span class="n">class_docstring</span><span class="o">=</span><span class="s2">&quot;elucidation&quot;</span>
    <span class="p">)</span>
    <span class="c1"># Clean up data frame with new concepts</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">_clean_dataframe</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># Add entities</span>
    <span class="n">onto</span><span class="p">,</span> <span class="n">entities_with_errors</span><span class="p">,</span> <span class="n">added_concept_indices</span> <span class="o">=</span> <span class="n">_add_entities</span><span class="p">(</span>
        <span class="n">onto</span><span class="o">=</span><span class="n">onto</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">entitytype</span><span class="o">=</span><span class="n">owlready2</span><span class="o">.</span><span class="n">ThingClass</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span>
    <span class="p">)</span>

    <span class="c1"># Add entity properties in a second loop</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">added_concept_indices</span><span class="p">:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Relations&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">properties</span> <span class="o">==</span> <span class="s2">&quot;nan&quot;</span><span class="p">:</span>
            <span class="n">properties</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">properties</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">entity</span> <span class="o">=</span> <span class="n">onto</span><span class="o">.</span><span class="n">get_by_label</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;prefLabel&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="k">except</span> <span class="n">NoSuchLabelError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">entity</span><span class="o">.</span><span class="n">is_a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evaluate</span><span class="p">(</span><span class="n">onto</span><span class="p">,</span> <span class="n">prop</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
                <span class="k">except</span> <span class="n">pyparsing</span><span class="o">.</span><span class="n">ParseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="c1"># This is currently not tested</span>
                        <span class="sa">f</span><span class="s2">&quot;Error in Property assignment for: &#39;</span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Property to be Evaluated: &#39;</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    <span class="n">entities_with_errors</span><span class="p">[</span><span class="s2">&quot;errors_in_properties&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">entity</span><span class="o">.</span><span class="n">name</span>
                    <span class="p">)</span>
                <span class="k">except</span> <span class="n">NoSuchLabelError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Error in Property assignment for: </span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s2">. &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Property to be Evaluated: </span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s2">. &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">force</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                        <span class="n">entities_with_errors</span><span class="p">[</span><span class="s2">&quot;errors_in_properties&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">entity</span><span class="o">.</span><span class="n">name</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">ExcelError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>

    <span class="c1"># Add range and domain for object properties</span>
    <span class="k">if</span> <span class="n">objectproperties</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">onto</span><span class="p">,</span> <span class="n">objectproperties_with_errors</span> <span class="o">=</span> <span class="n">_add_range_domain</span><span class="p">(</span>
            <span class="n">onto</span><span class="o">=</span><span class="n">onto</span><span class="p">,</span>
            <span class="n">properties</span><span class="o">=</span><span class="n">objectproperties</span><span class="p">,</span>
            <span class="n">added_prop_indices</span><span class="o">=</span><span class="n">added_objprop_indices</span><span class="p">,</span>
            <span class="n">properties_with_errors</span><span class="o">=</span><span class="n">objectproperties_with_errors</span><span class="p">,</span>
            <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">objectproperties_with_errors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">entities_with_errors</span><span class="p">[</span><span class="s2">&quot;obj_prop_&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="c1"># Add range and domain for annotation properties</span>
    <span class="k">if</span> <span class="n">annotationproperties</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">onto</span><span class="p">,</span> <span class="n">annotationproperties_with_errors</span> <span class="o">=</span> <span class="n">_add_range_domain</span><span class="p">(</span>
            <span class="n">onto</span><span class="o">=</span><span class="n">onto</span><span class="p">,</span>
            <span class="n">properties</span><span class="o">=</span><span class="n">annotationproperties</span><span class="p">,</span>
            <span class="n">added_prop_indices</span><span class="o">=</span><span class="n">added_annotprop_indices</span><span class="p">,</span>
            <span class="n">properties_with_errors</span><span class="o">=</span><span class="n">annotationproperties_with_errors</span><span class="p">,</span>
            <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">annotationproperties_with_errors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">entities_with_errors</span><span class="p">[</span><span class="s2">&quot;annot_prop_&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1"># Add range and domain for data properties</span>
    <span class="k">if</span> <span class="n">dataproperties</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">onto</span><span class="p">,</span> <span class="n">dataproperties_with_errors</span> <span class="o">=</span> <span class="n">_add_range_domain</span><span class="p">(</span>
            <span class="n">onto</span><span class="o">=</span><span class="n">onto</span><span class="p">,</span>
            <span class="n">properties</span><span class="o">=</span><span class="n">dataproperties</span><span class="p">,</span>
            <span class="n">added_prop_indices</span><span class="o">=</span><span class="n">added_dataprop_indices</span><span class="p">,</span>
            <span class="n">properties_with_errors</span><span class="o">=</span><span class="n">dataproperties_with_errors</span><span class="p">,</span>
            <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dataproperties_with_errors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">entities_with_errors</span><span class="p">[</span><span class="s2">&quot;data_prop_&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1"># Synchronise Python attributes to ontology</span>
    <span class="n">onto</span><span class="o">.</span><span class="n">sync_attributes</span><span class="p">(</span>
        <span class="n">name_policy</span><span class="o">=</span><span class="s2">&quot;uuid&quot;</span><span class="p">,</span> <span class="n">name_prefix</span><span class="o">=</span><span class="s2">&quot;EMMO_&quot;</span><span class="p">,</span> <span class="n">class_docstring</span><span class="o">=</span><span class="s2">&quot;elucidation&quot;</span>
    <span class="p">)</span>
    <span class="n">onto</span><span class="o">.</span><span class="n">dir_label</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">entities_with_errors</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">entities_with_errors</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">onto</span><span class="p">,</span> <span class="n">catalog</span><span class="p">,</span> <span class="n">entities_with_errors</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="ontopy.excelparser.get_metadata_from_dataframe" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_metadata_from_dataframe</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">base_iri</span><span class="p">,</span> <span class="n">base_iri_from_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">imports</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#ontopy.excelparser.get_metadata_from_dataframe" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Create ontology with metadata from pd.DataFrame</p>

        <details class="quote">
          <summary>Source code in <code>ontopy/excelparser.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_metadata_from_dataframe</span><span class="p">(</span>  <span class="c1"># pylint: disable=too-many-locals,too-many-branches,too-many-statements</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">base_iri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">base_iri_from_metadata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">imports</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">ontopy</span><span class="o">.</span><span class="n">ontology</span><span class="o">.</span><span class="n">Ontology</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create ontology with metadata from pd.DataFrame&quot;&quot;&quot;</span>

    <span class="c1"># base_iri from metadata if it exists and base_iri_from_metadata</span>
    <span class="k">if</span> <span class="n">base_iri_from_metadata</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">base_iris</span> <span class="o">=</span> <span class="n">_parse_literal</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="s2">&quot;Ontology IRI&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_iris</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;More than one Ontology IRI given. The first was chosen.&quot;</span>
                <span class="p">)</span>
            <span class="n">base_iri</span> <span class="o">=</span> <span class="n">base_iris</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;#&quot;</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="k">pass</span>

    <span class="c1"># Create new ontology</span>
    <span class="n">onto</span> <span class="o">=</span> <span class="n">get_ontology</span><span class="p">(</span><span class="n">base_iri</span><span class="p">)</span>

    <span class="c1"># Add imported ontologies</span>
    <span class="n">catalog</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">catalog</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">catalog</span>
    <span class="n">locations</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">imports</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="c1"># for location in imports:</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Imported ontologies&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="ow">and</span> <span class="n">location</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">locations</span><span class="p">:</span>
            <span class="n">imported</span> <span class="o">=</span> <span class="n">onto</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">get_ontology</span><span class="p">(</span><span class="n">location</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
            <span class="n">onto</span><span class="o">.</span><span class="n">imported_ontologies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imported</span><span class="p">)</span>
            <span class="n">catalog</span><span class="p">[</span><span class="n">imported</span><span class="o">.</span><span class="n">base_iri</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;#/&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">location</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">cat</span> <span class="o">=</span> <span class="n">read_catalog</span><span class="p">(</span><span class="n">location</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">catalog</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">ReadCatalogError</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Catalog for </span><span class="si">{</span><span class="n">imported</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">)</span>
            <span class="n">locations</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
        <span class="c1"># set defined prefix</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;prefix&quot;</span><span class="p">]):</span>
            <span class="c1"># set prefix for all ontologies with same &#39;base_iri_root&#39;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;base_iri_root&quot;</span><span class="p">]):</span>
                <span class="n">onto</span><span class="o">.</span><span class="n">set_common_prefix</span><span class="p">(</span>
                    <span class="n">iri_base</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;base_iri_root&quot;</span><span class="p">],</span> <span class="n">prefix</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;prefix&quot;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="c1"># If base_root not given, set prefix only to top ontology</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">imported</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;prefix&quot;</span><span class="p">]</span>

    <span class="k">with</span> <span class="n">onto</span><span class="p">:</span>
        <span class="c1"># Add title</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_add_literal</span><span class="p">(</span>
                <span class="n">metadata</span><span class="p">,</span>
                <span class="n">onto</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
                <span class="s2">&quot;Title&quot;</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">only_one</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># Add license</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_add_literal</span><span class="p">(</span>
                <span class="n">metadata</span><span class="p">,</span> <span class="n">onto</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">license</span><span class="p">,</span> <span class="s2">&quot;License&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># Add authors/creators</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_add_literal</span><span class="p">(</span>
                <span class="n">metadata</span><span class="p">,</span> <span class="n">onto</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">creator</span><span class="p">,</span> <span class="s2">&quot;Author&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># Add contributors</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_add_literal</span><span class="p">(</span>
                <span class="n">metadata</span><span class="p">,</span>
                <span class="n">onto</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">contributor</span><span class="p">,</span>
                <span class="s2">&quot;Contributor&quot;</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># Add versionInfo</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_add_literal</span><span class="p">(</span>
                <span class="n">metadata</span><span class="p">,</span>
                <span class="n">onto</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">versionInfo</span><span class="p">,</span>
                <span class="s2">&quot;Ontology version Info&quot;</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">only_one</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">onto</span><span class="p">,</span> <span class="n">catalog</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2019-2022 SINTEF
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/emmo-repo" target="_blank" rel="noopener" title="EMMO on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.top", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.6c14ae12.min.js"></script>
      
    
  </body>
</html>